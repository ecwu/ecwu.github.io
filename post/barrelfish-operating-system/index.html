<!DOCTYPE html><html lang="en">
    <head>

<link rel="icon" type="image/x-icon" href="https://ecwuuuuu.com/favicon.ico">




<link rel="stylesheet" href="https://ecwuuuuu.com/css/style.min.744725dcb7cf600fb6c5cb9d56c898a6af45d86759410d7e6058efc92a19d2e7.css" integrity="sha256-dEcl3LfPYA&#43;2xcudVsiYpq9F2GdZQQ1&#43;YFjvySoZ0uc=">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Barrelfish OS 和多内核操作系统 -  ECWU&#39;s Notebook</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Homepage and blog for Zhenghao Wu (ECWU), sharing thoughts on technology, everyday experiences, and photography. Engaging with the community through knowledge sharing.">
<meta name="keywords" content="OS,Operating System,Barrelfish OS,Multi-kernel,ETH Zurich,UIC,Computer Science">
<meta name="author" content="ECWUUUUU"><script>
  
  (function() {
    const theme = localStorage.getItem("current-theme");
    
    if (theme === null) {
      
      if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        localStorage.setItem("current-theme", "dark");
        document.documentElement.classList.add('dark');
      } else {
        localStorage.setItem("current-theme", "light");
        document.documentElement.classList.remove('dark');
      }
    } else if (theme === 'dark') {
      
      document.documentElement.classList.add('dark');
    } else {
      
      document.documentElement.classList.remove('dark');
    }
  })();

  
  
  window.updateMermaidTheme = () => {
    if (typeof mermaid !== 'undefined') {
      const isDark = document.documentElement.classList.contains("dark");

      const mermaids = document.querySelectorAll('pre.mermaid');
      mermaids.forEach(e => {
        if (e.getAttribute('data-processed')) {
          
          e.removeAttribute('data-processed');
          
          e.innerHTML = e.getAttribute('data-graph');
        } else {
          
          e.setAttribute('data-graph', e.textContent);
        }
      });

      if (isDark) {
        initMermaidDark();
        mermaid.run();
      } else {
        initMermaidLight();
        mermaid.run();
      }
    }
  }

  function change_color_mode(){
    if (localStorage.getItem('current-theme') === 'light') {
      document.documentElement.classList.add('dark')
      localStorage.setItem('current-theme', 'dark');
      change_discussion_color_mode();
      updateMermaidTheme();
    } else {
      document.documentElement.classList.remove('dark')
      localStorage.setItem('current-theme', 'light');
      change_discussion_color_mode();
      updateMermaidTheme();
    }
  }
  

  function change_discussion_color_mode(){
    
    
    
  }

  
  

  document.addEventListener("DOMContentLoaded", () => {
    

    document
      .getElementById("header-theme-button")
      .addEventListener("click", change_color_mode);
  });

</script>

</head>
    <body class="transition-colors duration-300"><div class="pt-6">
    
    <div class="nav-title flex flex-row flex-wrap gap-2"><a href="https://ecwuuuuu.com/">
    
    <svg class="w-36 fill-gray-900 dark:fill-gray-200" fill="currentColor" viewBox="0 0 204.24 43.44" xmlns="http://www.w3.org/2000/svg">
        <path d="M0,43.08V0.36h18.24v5.76H6.12v12.54h10.56v5.76H6.12v12.54h12.12v6.12H0z"/>
        <path d="M41.64,30.9v2.64c0,1.32-0.25,2.57-0.75,3.75c-0.5,1.18-1.19,2.23-2.07,3.15c-0.88,0.92-1.91,1.65-3.09,2.19  c-1.18,0.54-2.45,0.81-3.81,0.81c-1.16,0-2.34-0.16-3.54-0.48c-1.2-0.32-2.28-0.88-3.24-1.68s-1.75-1.83-2.37-3.09  c-0.62-1.26-0.93-2.87-0.93-4.83V9.84c0-1.4,0.24-2.7,0.72-3.9c0.48-1.2,1.16-2.24,2.04-3.12c0.88-0.88,1.93-1.57,3.15-2.07  C28.97,0.25,30.32,0,31.8,0c2.88,0,5.22,0.94,7.02,2.82c0.88,0.92,1.57,2.01,2.07,3.27c0.5,1.26,0.75,2.63,0.75,4.11v2.4h-6.12  v-2.04c0-1.2-0.34-2.24-1.02-3.12c-0.68-0.88-1.6-1.32-2.76-1.32c-1.52,0-2.53,0.47-3.03,1.41c-0.5,0.94-0.75,2.13-0.75,3.57v21.84  c0,1.24,0.27,2.28,0.81,3.12s1.51,1.26,2.91,1.26c0.4,0,0.83-0.07,1.29-0.21c0.46-0.14,0.89-0.37,1.29-0.69  c0.36-0.32,0.66-0.76,0.9-1.32c0.24-0.56,0.36-1.26,0.36-2.1v-2.1H41.64z"/>
        <path d="M78.36,0.36L72,43.08h-5.76l-4.68-27.72h-0.12l-4.62,27.72h-5.76L44.7,0.36h6.48l3.06,27.12h0.12l4.8-27.12h4.68l4.98,27.78  h0.12l2.94-27.78H78.36z"/>
        <path d="M102,0.36v33.12c0,1.4-0.25,2.69-0.75,3.87c-0.5,1.18-1.21,2.23-2.13,3.15c-0.92,0.92-1.98,1.64-3.18,2.16  c-1.2,0.52-2.48,0.78-3.84,0.78c-1.36,0-2.63-0.26-3.81-0.78c-1.18-0.52-2.23-1.24-3.15-2.16c-0.92-0.92-1.64-1.97-2.16-3.15  c-0.52-1.18-0.78-2.47-0.78-3.87V0.36h6.12v32.52c0,1.52,0.36,2.64,1.08,3.36c0.72,0.72,1.62,1.08,2.7,1.08  c1.08,0,1.98-0.36,2.7-1.08c0.72-0.72,1.08-1.84,1.08-3.36V0.36H102z"/>
        <path d="M127.56,0.36v33.12c0,1.4-0.25,2.69-0.75,3.87c-0.5,1.18-1.21,2.23-2.13,3.15c-0.92,0.92-1.98,1.64-3.18,2.16  s-2.48,0.78-3.84,0.78s-2.63-0.26-3.81-0.78c-1.18-0.52-2.23-1.24-3.15-2.16c-0.92-0.92-1.64-1.97-2.16-3.15  c-0.52-1.18-0.78-2.47-0.78-3.87V0.36h6.12v32.52c0,1.52,0.36,2.64,1.08,3.36c0.72,0.72,1.62,1.08,2.7,1.08  c1.08,0,1.98-0.36,2.7-1.08c0.72-0.72,1.08-1.84,1.08-3.36V0.36H127.56z"/>
        <path d="M153.12,0.36v33.12c0,1.4-0.25,2.69-0.75,3.87c-0.5,1.18-1.21,2.23-2.13,3.15c-0.92,0.92-1.98,1.64-3.18,2.16  c-1.2,0.52-2.48,0.78-3.84,0.78s-2.63-0.26-3.81-0.78c-1.18-0.52-2.23-1.24-3.15-2.16c-0.92-0.92-1.64-1.97-2.16-3.15  c-0.52-1.18-0.78-2.47-0.78-3.87V0.36h6.12v32.52c0,1.52,0.36,2.64,1.08,3.36c0.72,0.72,1.62,1.08,2.7,1.08s1.98-0.36,2.7-1.08  c0.72-0.72,1.08-1.84,1.08-3.36V0.36H153.12z"/>
        <path d="M178.68,0.36v33.12c0,1.4-0.25,2.69-0.75,3.87c-0.5,1.18-1.21,2.23-2.13,3.15c-0.92,0.92-1.98,1.64-3.18,2.16  c-1.2,0.52-2.48,0.78-3.84,0.78c-1.36,0-2.63-0.26-3.81-0.78c-1.18-0.52-2.23-1.24-3.15-2.16c-0.92-0.92-1.64-1.97-2.16-3.15  c-0.52-1.18-0.78-2.47-0.78-3.87V0.36H165v32.52c0,1.52,0.36,2.64,1.08,3.36c0.72,0.72,1.62,1.08,2.7,1.08  c1.08,0,1.98-0.36,2.7-1.08c0.72-0.72,1.08-1.84,1.08-3.36V0.36H178.68z"/>
        <path d="M204.24,0.36v33.12c0,1.4-0.25,2.69-0.75,3.87c-0.5,1.18-1.21,2.23-2.13,3.15c-0.92,0.92-1.98,1.64-3.18,2.16  c-1.2,0.52-2.48,0.78-3.84,0.78s-2.63-0.26-3.81-0.78c-1.18-0.52-2.23-1.24-3.15-2.16c-0.92-0.92-1.64-1.97-2.16-3.15  c-0.52-1.18-0.78-2.47-0.78-3.87V0.36h6.12v32.52c0,1.52,0.36,2.64,1.08,3.36c0.72,0.72,1.62,1.08,2.7,1.08s1.98-0.36,2.7-1.08  c0.72-0.72,1.08-1.84,1.08-3.36V0.36H204.24z"/>
    </svg>
    <p class="sr-only">ECWU Homepage</p>
    
</a></div>
    
<nav aria-label="navbar" class="mb-3 mr-8">
    <ol role="list" class="flex flex-wrap">
        
        
        
        <li>
        <div class="flex items-center justify-center">
            <a href="https://ecwuuuuu.com/" class='mr-2 font-medium text-gray-900 dark:text-gray-200 visited:text-gray-900 dark:visited:text-gray-200'>Home</a>
            
            <svg width="16" height="20" viewBox="0 0 16 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                aria-hidden="true" class="mr-2 w-4 h-5 fill-gray-300">
                <path d="M5.697 4.34L8.98 16.532h1.327L7.025 4.341H5.697z" />
            </svg>
            
        </div>
        </li>
        
        <li>
        <div class="flex items-center justify-center">
            <a href="https://ecwuuuuu.com/post/" class='mr-2 font-medium text-gray-900 dark:text-gray-200 visited:text-gray-900 dark:visited:text-gray-200'>Posts</a>
            
            <svg width="16" height="20" viewBox="0 0 16 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                aria-hidden="true" class="mr-2 w-4 h-5 fill-gray-300">
                <path d="M5.697 4.34L8.98 16.532h1.327L7.025 4.341H5.697z" />
            </svg>
            
        </div>
        </li>
        
        <li>
        <div class="flex items-center justify-center">
            <a href="https://ecwuuuuu.com/photography/" class='mr-2 font-medium text-gray-900 dark:text-gray-200 visited:text-gray-900 dark:visited:text-gray-200'>Photos</a>
            
            <svg width="16" height="20" viewBox="0 0 16 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                aria-hidden="true" class="mr-2 w-4 h-5 fill-gray-300">
                <path d="M5.697 4.34L8.98 16.532h1.327L7.025 4.341H5.697z" />
            </svg>
            
        </div>
        </li>
        
        <li>
        <div class="flex items-center justify-center">
            <a href="https://ecwuuuuu.com/series/" class='mr-2 font-medium text-gray-900 dark:text-gray-200 visited:text-gray-900 dark:visited:text-gray-200'>Series</a>
            
            <svg width="16" height="20" viewBox="0 0 16 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                aria-hidden="true" class="mr-2 w-4 h-5 fill-gray-300">
                <path d="M5.697 4.34L8.98 16.532h1.327L7.025 4.341H5.697z" />
            </svg>
            
        </div>
        </li>
        
        <li>
        <div class="flex items-center justify-center">
            <a href="https://ecwuuuuu.com/page/about/" class='mr-2 font-medium text-gray-900 dark:text-gray-200 visited:text-gray-900 dark:visited:text-gray-200'>About</a>
            
            <svg width="16" height="20" viewBox="0 0 16 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                aria-hidden="true" class="mr-2 w-4 h-5 fill-gray-300">
                <path d="M5.697 4.34L8.98 16.532h1.327L7.025 4.341H5.697z" />
            </svg>
            
        </div>
        </li>
        
        <li>
        <div class="flex items-center justify-center">
            <a href="https://ecwuuuuu.com/page/friends/" class='mr-2 font-medium text-gray-900 dark:text-gray-200 visited:text-gray-900 dark:visited:text-gray-200'>Friends</a>
            
            
        </div>
        </li>
        
    </ol>
</nav><div  class="flex items-center space-x-2">
    <div class="w-6 h-6 inline-flex items-center justify-center rounded-lg bg-white dark:bg-black shadow-inner ring-1 ring-black/5">
        <i id="header-theme-button" data-feather="sun" class="site-header-navlink rounded cursor-pointer">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun-icon lucide-sun h-4 w-4 block dark:hidden fill-gray-900 dark:fill-gray-200"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon-icon lucide-moon h-4 w-4 hidden dark:block fill-gray-900 dark:fill-gray-200"><path d="M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401"/></svg>
        </i>
    </div>
    <span class="dark:hidden text-sm">To Dark Mode</span>
    <span class="hidden dark:block dark:text-gray-200 text-sm">To Light Mode</span>
</div></div><div class="mb-12 mt-16 w-content">
  <h1 class="text-gray-900 dark:text-gray-200">Barrelfish OS 和多内核操作系统</h1>
  <h2 class="text-gray-700 dark:text-gray-400">Barrelfish OS and Multi-kernel Operating System</h2>

  
  <div class="text-gray-700 dark:text-gray-400">
    <div class="space-y-1">
      
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-signature-icon lucide-signature h-5 w-5 inline-block">
          <path d="m21 17-2.156-1.868A.5.5 0 0 0 18 15.5v.5a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1c0-2.545-3.991-3.97-8.5-4a1 1 0 0 0 0 5c4.153 0 4.745-11.295 5.708-13.5a2.5 2.5 0 1 1 3.31 3.284"/>
          <path d="M3 21h18"/>
        </svg> Zhenghao Wu</p>
      


      
      <p>
        
        <span class="mr-2">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar-clock-icon lucide-calendar-clock h-5 w-5 inline-block"><path d="M16 14v2.2l1.6 1"/><path d="M16 2v4"/>
          <path d="M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5"/>
          <path d="M3 10h5"/>
          <path d="M8 2v4"/>
          <circle cx="16" cy="16" r="6"/>
        </svg> Wednesday, January 9, 2019
        </span>
        

        
        <span>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard-clock-icon lucide-clipboard-clock h-5 w-5 inline-block">
          <path d="M16 14v2.2l1.6 1"/>
          <path d="M16 4h2a2 2 0 0 1 2 2v.832"/>
          <path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h2"/>
          <circle cx="16" cy="16" r="6"/>
          <rect x="8" y="2" width="8" height="4" rx="1"/>
        </svg> 4 min read
        </span>
        
      </p>
      

      
      <p>
        
        <span class="mr-2">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flag-icon lucide-flag h-5 w-5 inline-block">
          <path d="M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528"/>
        </svg>
        Status: Finished
        </span>
        
        
        <span class="mr-2">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-badge-check-icon lucide-badge-check h-5 w-5 inline-block">
          <path d="M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z"/>
          <path d="m9 12 2 2 4-4"/>
        </svg>
        Confidence: highly likely
        </span>
        
        
        <span>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-waypoints-icon lucide-waypoints h-5 w-5 inline-block">
          <circle cx="12" cy="4.5" r="2.5"/>
          <path d="m10.2 6.3-3.9 3.9"/>
          <circle cx="4.5" cy="12" r="2.5"/>
          <path d="M7 12h10"/>
          <circle cx="19.5" cy="12" r="2.5"/>
          <path d="m13.8 17.7 3.9-3.9"/>
          <circle cx="12" cy="19.5" r="2.5"/>
        </svg>
        Importance: 8
        </span>
        
      </p>
      
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-scroll-text-icon lucide-scroll-text h-5 w-5 inline-block">
          <path d="M15 12h-5"/>
          <path d="M15 8h-5"/>
          <path d="M19 17V5a2 2 0 0 0-2-2H4"/>
          <path d="M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3"/>
        </svg> <a href="#article-info-card">Post Details</a>
      </p>
      
      
    </div>
  </div>
  
</div><main>
<article class="prose dark:prose-invert lg:prose-xl md:prose-lg prose-ul:leading-5 prose-ol:leading-5">
    
<section class="mb-8">
  <details closed class="toc">
    <summary>Table of Contents</summary>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#什么是-barrelfish-os">什么是 Barrelfish OS</a>
      <ul>
        <li><a href="#背景">背景</a></li>
        <li><a href="#现状">现状</a></li>
        <li><a href="#特点">特点</a></li>
      </ul>
    </li>
    <li><a href="#多内核架构multikernel-architecture">多内核架构（Multikernel Architecture）</a></li>
    <li><a href="#程序在-barrelfish-os-上运行">程序在 Barrelfish OS 上运行</a></li>
    <li><a href="#内存">内存</a></li>
    <li><a href="#安装-barrelfish-os">安装 Barrelfish OS</a></li>
    <li><a href="#总结">总结</a></li>
  </ul>
</nav>
  </details>
</section>

    <p>大三的上学期有一门专业课叫操作系统（Operating System），它的课程小组项目是对某个操作系统进行研究。我们组抽到了 Barrelfish Operating System。</p>
<p>
<figure class="w-full">
  <img src="https://cdn.ecwuuuuu.com/blog/image/barrelfish-logo.jpg-compressed.webp" alt="Barrelfish OS Logo" class="rounded-lg">

  <figcaption>
  <strong>Barrelfish OS Logo </strong>
  
  
  
  
  </figcaption>
</figure>



  </section>

</p>
<p>这是一个试验操作系统，几乎从零开始设计，并提出了许多全新的概念。虽然官方网站上给出了许多文档，我们依然花了许多时间来理解这个系统的架构。</p>
<h2 id="什么是-barrelfish-os">什么是 Barrelfish OS</h2>
<h3 id="背景">背景</h3>
<p>Barrelfish OS 是由苏黎世联邦理工大学
<figure class="w-full">
  <img src="https://cdn.ecwuuuuu.com/blog/image/ETHzurich-logo.png-compressed.webp"  class="rounded-lg">

  <figcaption>
  <strong>ETH Zurich Logo </strong>
  
  
  
  
  </figcaption>
</figure>



  </section>

系统小组（ETH Zurich Systems Group）与微软剑桥研究院（Microsoft Research Cambridge）于 2007 年开始研究开发的实验操作系统（这种操作系统主要被研究者用于实践提出的新概念或想法）。</p>
<h3 id="现状">现状</h3>
<p>系统到目前为止依然有更新，最新的一次版本（Release）是在 2018 年 10 月 4 日发布的（添加了对 Ubuntu 18.04 LTS 作为构建环境的支持）。</p>
<p>虽然经过了多年的开发，这个系统远达不到可用的地步。运行需要 QEMU，而且非常不稳定。<span class="px-2 py-1 text-gray-700 bg-gray-300 bg-stripes bg-stripes-white dark:text-gray-400 dark:bg-slate-700 dark:bg-stripes-slate-900 rounded-md">我构建安装的 Barrelfish OS，运行提供的 <code>demo</code> 演示程序就会崩溃 🤨；从来没有成功拉起过网卡驱动。（当然也可能跟我迷醉的运行方式有关：在 macOS 上通过 Teamviewer 远程至一个 Windows 台式机上 VirtualBox 软件上的 Ubuntu 18.04 虚拟机；在虚拟机中运行 QEMU 模拟的 Barrelfish OS）</span></p>
<h3 id="特点">特点</h3>
<p>Barrelfish OS 最大的特点就是多内核（Multikernel）。研究者认为目前的操作系统不是为拥有大量运算核心的计算机而设计的，同时多核心处理器是未来运算芯片的趋势（因为提高时钟速度来提高性能也会造成更大的功耗和发热）。Barrelfish OS 就是为了更好的利用多核芯处理器计算机而出现的。虽然有些国内的媒体听见风就是雨以为这个微软参与的项目会诞生一个替代 Windows 的产品，但需要注意的是，Barrelfish OS 并不是 Windows 的替代品，它只是为了实践提出的新概念或想法，这也正是实验操作系统的意义。</p>
<h2 id="多内核架构multikernel-architecture">多内核架构（Multikernel Architecture）</h2>
<p>
<figure class="w-full">
  <img src="https://www.microsoft.com/en-us/research/wp-content/uploads/2016/10/multikernel-model.jpg" alt="alt" class="rounded-lg">

  <figcaption>
  <strong>The Multikernel model </strong>
  Support heterogeneous cores to work together
  <a href="https://www.microsoft.com/en-us/research/blog/barrelfish-exploring-multicore-os/">
  Microsoft Research
  </a>
  </figcaption>
</figure>



  </section>

</p>
<p>Barrelfish OS 研究人员面临的主要挑战是可扩展性，包括硬件核心的拓展和异构硬件（如何将 ARM 的芯片和 Intel 的芯片一起管理）的拓展。</p>
<p>研究人员提出了多内核（Multikernel）的概念。与传统的一个内核负责管理调度所有的核心不同，多内核是在每一个核心上都运行一个独立的内核，该内核只负责调度这一核内的资源，不同的内核之间再显式的进行通信（不直接进行通信）。</p>
<p>Barrelfish OS 上的内核被称为 CPU Driver (核心处理器驱动)。它是一个单线程且不可被抢占的程序，会承担调度程序在 CPU 上运行的行为。</p>
<h2 id="程序在-barrelfish-os-上运行">程序在 Barrelfish OS 上运行</h2>
<p>
<figure class="w-full">
  <img src="https://i.loli.net/2019/09/02/n7sP5GDLjkm4XUz.png" alt="alt" class="rounded-lg">

  <figcaption>
  <strong>Interactions between Barrelfish’s core components </strong>
  Dissertation figure in: 
  <a href="https://people.eecs.berkeley.edu/~maas/maas-bathesis.pdf">
  A JVM for the Barrelfish Operating System
  </a>
  </figcaption>
</figure>



  </section>

</p>
<p>程序（Program）在传统的操作系统上运行是通过进程（Process）的形式。而 Barrelfish OS 是通过 Dispatcher 的形式。</p>
<p>一个程序运行后以一个 Dispatcher 的形式运行在 CPU 中，如果一个程序有多个进程同时运行，那么则会有多个 Dispatcher 运行在多个 CPU 上。Dispatcher 要做的是指定一个线程并让该线程运行。</p>
<p>多个 Dispatcher 形成一个 Domain（域）的概念，进而会涉及到域之间通信的问题（类似程序间通信，用的是一种类似 RPC 的通信方法），但是这篇文章中不会涉及这个内容。</p>
<p>因为核心之间不能直接进行通信，所以 Monitor 被引入了（这个 Monitor 与同步问题中的管程不同）。程序可以通过 Monitor 进行核之间的信息交流。</p>
<p>总结一下，CPU Driver 会调度 Dispatcher 运行，Dispatcher 再调度一个线程运行。Dispatcher 和线程都可以被抢断。</p>
<h2 id="内存">内存</h2>
<blockquote>
<p>我们没有将内存研究的非常深，这里只根据我的理解，简单的介绍。</p>
</blockquote>
<p>Barrelfish OS 从 <a href="https://sel4.systems">seL4</a>
<figure class="w-full">
  <img src="https://sel4.systems/images/logo-text-white.svg"  class="rounded-lg">

  <figcaption>
  <strong>seL4 Logo </strong>
  
  
  
  
  </figcaption>
</figure>



  </section>

引入了 Capability。因为运行在 CPU 上的程序不能直接访问内存，所以它们通过访问 Capabilities Reference 并通过逐层的 CNode 索引，最后找到 Capability。最后再通过 Capability 找到最终的物理内存地址。</p>
<p>Capability 的引入有一定的原因是为了安全的内存访问。</p>
<h2 id="安装-barrelfish-os">安装 Barrelfish OS</h2>
<p>我是在一个 Ubuntu 18.04 的虚拟机上构建的 Barrelfish OS，构建时依照了<a href="http://wiki.barrelfish.org/Getting_Started">官方维基</a>内提供的步骤，不要遗漏一些包文件就不会在构建时遇到问题。</p>
<p>运行时遇到了比较多的问题，包括网卡设置不匹配，模拟器无法启动。最后在 <a href="https://www.github.com/lmy441900">@lmy441900</a> 和 <a href="https://www.github.com/DRJ31">@DRJ31</a> 的帮助下，我们安装了 QEMU，并通过 QEMU 模拟了一个两核心的电脑运行 Barrelfish OS。</p>
<h2 id="总结">总结</h2>
<p>这篇文章并不是对 Barrelfish OS 的完整概述，只是我在学期结束后的假期里，对这个小组作业的小小回顾。<span class="px-2 py-1 text-gray-700 bg-gray-300 bg-stripes bg-stripes-white dark:text-gray-400 dark:bg-slate-700 dark:bg-stripes-slate-900 rounded-md">像内核之间的通信，核内的通信，两种抢占机制，Capability 索引的细节，系统管理硬件的方式，这里都没有提到。</span></p>
<p>就像菲利普教授说的 &ldquo;Barrelfish is fun.&quot;， 研究深入后确实能体会这个系统的乐趣，但同时也因为多内核这种全新的架构设计所引入的新概念和解决方案，让初学者很难快速理解整个系统。如果你正在研究这个系统，我能给的一点小建议是：好好利用官方提供的 <a href="http://www.barrelfish.org/publications/TN-001-Glossary.pdf">Glossary （术语表）</a>。</p>
<p>Barrelfish 不能成为下一个 Windows。但它能像官网里展望所说的，它能成为未来多核 / 多内核操作系统的研究平台，为多内核操作系统奠基。</p>
<hr>
<p>The group project mentioned in this article was completed by Zhenghao Wu (@ECWU), Turing Qiu (<a href="https://github.com/yfqiu98">@yfqiu98</a>), and Otto Zhang (<a href="https://github.com/zhanggzzy">@zhanggzzy</a>)</p>
</article>
</main>
<div class="pb-10 w-content">
  <div class="bg-white dark:bg-gray-900 drop-shadow-lg overflow-hidden sm:rounded-lg">
    <div class="px-4 py-5 sm:px-6">
      <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-gray-200">
        <a id="article-info-card"></a>
        Article Card
      </h3>
      <p class="mt-1 text-sm text-gray-500">
        For "<span class="italic">Barrelfish OS 和多内核操作系统</span>"
      </p>
    </div>
    <div class="border-t border-gray-200 dark:border-gray-700">
      <dl>
        <table class="border-collapse table-fixed w-full">
          <tbody class="bg-white dark:bg-gray-800">
            
            <tr class="px-4 py-5">
              <th
                class="text-left border-b border-gray-100 dark:border-gray-700 pl-6 dark:text-gray-500 w-1/3 px-4 py-5 text-sm font-medium text-gray-500">
                Author</td>
              <td
                class="border-b font-bold border-gray-100 dark:border-gray-700 p-4 pl-8 text-gray-500 dark:text-gray-400 mt-1 px-4 py-5 text-sm ">
                Zhenghao Wu</td>
            </tr>
            
            
            <tr class="px-4 py-5">
              <th
                class="text-left border-b border-gray-100 dark:border-gray-700 pl-6 dark:text-gray-500 w-1/3 px-4 py-5 text-sm font-medium text-gray-500">
                Publish & Update Date</td>
              <td
                class="font-bold border-b border-gray-100 dark:border-gray-700 p-4 pl-8 text-gray-500 dark:text-gray-400 mt-1 px-4 py-5 text-sm">
                2019-01-09</td>
            </tr>
            
            
            <tr class="px-4 py-5">
              <th
                class="text-left border-b border-gray-100 dark:border-gray-700 pl-6 dark:text-gray-500 w-1/3 px-4 py-5 text-sm font-medium text-gray-500">
                Tags</td>
              <td
                class="font-bold border-b border-gray-100 dark:border-gray-700 p-4 pl-8 text-gray-500 dark:text-gray-400 mt-1 px-4 py-5 text-sm">
                
                <a class="rounded inline-block mt-1 mb-1 py-1 px-2 text-xs font-medium text-white bg-gray-900 visited:text-white dark:visited:text-white"
                  href="https://ecwuuuuu.com/tags/os">OS</a>
                
                <a class="rounded inline-block mt-1 mb-1 py-1 px-2 text-xs font-medium text-white bg-gray-900 visited:text-white dark:visited:text-white"
                  href="https://ecwuuuuu.com/tags/operating-system">Operating System</a>
                
                <a class="rounded inline-block mt-1 mb-1 py-1 px-2 text-xs font-medium text-white bg-gray-900 visited:text-white dark:visited:text-white"
                  href="https://ecwuuuuu.com/tags/barrelfish-os">Barrelfish OS</a>
                
                <a class="rounded inline-block mt-1 mb-1 py-1 px-2 text-xs font-medium text-white bg-gray-900 visited:text-white dark:visited:text-white"
                  href="https://ecwuuuuu.com/tags/multi-kernel">Multi-kernel</a>
                
                <a class="rounded inline-block mt-1 mb-1 py-1 px-2 text-xs font-medium text-white bg-gray-900 visited:text-white dark:visited:text-white"
                  href="https://ecwuuuuu.com/tags/eth-zurich">ETH Zurich</a>
                
                <a class="rounded inline-block mt-1 mb-1 py-1 px-2 text-xs font-medium text-white bg-gray-900 visited:text-white dark:visited:text-white"
                  href="https://ecwuuuuu.com/tags/uic">UIC</a>
                
                <a class="rounded inline-block mt-1 mb-1 py-1 px-2 text-xs font-medium text-white bg-gray-900 visited:text-white dark:visited:text-white"
                  href="https://ecwuuuuu.com/tags/computer-science">Computer Science</a>
                
              </td>
            </tr>
            
            
            <tr class="px-4 py-5">
              <th
                class="text-left border-b border-gray-100 dark:border-gray-700 pl-6 dark:text-gray-500 w-1/3 px-4 py-5 text-sm font-medium text-gray-500">
                Extra Materials</td>
              <td
                class="font-bold border-b border-gray-100 dark:border-gray-700 p-4 pl-8 text-gray-500 dark:text-gray-400 mt-1 px-4 py-5 text-sm">
                <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                  <ul role="list"
                    class="border border-gray-200 dark:border-gray-700 rounded-md divide-y divide-gray-200 dark:divide-gray-700">
                    
                    <li class="pl-3 pr-4 py-3 flex items-center justify-between text-sm">
                      <div class="w-0 flex-1 flex items-center">
                        
                        
                        
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link-icon lucide-link flex-shrink-0 h-5 w-5 text-gray-400"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>

                        
                        
                        <span class="ml-2 flex-1 w-0 truncate text-gray-900 dark:text-gray-200">
                          Barrelfish Operating System Homepage
                        </span>
                      </div>
                      <div class="ml-4 flex-shrink-0">
                        <a href="http://www.barrelfish.org/index.html" class="font-medium text-indigo-600 hover:text-indigo-500">
                          Check
                        </a>
                      </div>
                    </li>
                    
                    <li class="pl-3 pr-4 py-3 flex items-center justify-between text-sm">
                      <div class="w-0 flex-1 flex items-center">
                        
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-icon lucide-file flex-shrink-0 h-5 w-5 text-gray-400"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/></svg>
                        
                        
                        
                        
                        <span class="ml-2 flex-1 w-0 truncate text-gray-900 dark:text-gray-200">
                          Original Paper on Barrelfish OS - The Multikernel: A new OS architecture for scalable multicore systems
                        </span>
                      </div>
                      <div class="ml-4 flex-shrink-0">
                        <a href="http://www.barrelfish.org/publications/barrelfish_sosp09.pdf" class="font-medium text-indigo-600 hover:text-indigo-500">
                          Download
                        </a>
                      </div>
                    </li>
                    
                    <li class="pl-3 pr-4 py-3 flex items-center justify-between text-sm">
                      <div class="w-0 flex-1 flex items-center">
                        
                        
                        
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link-icon lucide-link flex-shrink-0 h-5 w-5 text-gray-400"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>

                        
                        
                        <span class="ml-2 flex-1 w-0 truncate text-gray-900 dark:text-gray-200">
                          An article from Microsoft about this topic - Barrelfish: Exploring a Multicore OS
                        </span>
                      </div>
                      <div class="ml-4 flex-shrink-0">
                        <a href="https://www.microsoft.com/en-us/research/blog/barrelfish-exploring-multicore-os/" class="font-medium text-indigo-600 hover:text-indigo-500">
                          Check
                        </a>
                      </div>
                    </li>
                    
                  </ul>
                </dd>
              </td>
            </tr>
            
            
            
            
            
          </tbody>
        </table>
    </div>
  </div>
</div>





<section class="mb-10">
<hr>
<h2 class="text-gray-900 dark:text-gray-200">Related Posts</h2>
<ul class="list-disc list-inside text-gray-900 dark:text-gray-200">
    
    <li><a href="https://ecwuuuuu.com/photography/uic-night/">UIC night</a></li>
    
    <li><a href="https://ecwuuuuu.com/photography/television-studio-production-at-hkbu/">Television Studio Production @ HKBU</a></li>
    
</ul>
</section>

<div>
  <footer class="relative mb-6 text-gray-900 dark:text-gray-200">
    <hr class="pb-5"><div class="flex justify-begin w-full mx-auto mb-2">
  <ul class="flex flex-row justify-begin text-lg space-x-2">
          

      
      <li>
          <a href="https://ecwuuuuu.com/index.xml" aria-label="RSS"
              class="round-button social-button">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="w-5 h-5 fill-gray-700 hover:fill-gray-900 dark:fill-gray-400 dark:hover:fill-gray-200" viewBox="0 0 16 16">
                <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm1.5 2.5c5.523 0 10 4.477 10 10a1 1 0 1 1-2 0 8 8 0 0 0-8-8 1 1 0 0 1 0-2zm0 4a6 6 0 0 1 6 6 1 1 0 1 1-2 0 4 4 0 0 0-4-4 1 1 0 0 1 0-2zm.5 7a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>
              </svg>
          </a>
      </li>
      
  </ul>
</div><p>
      
      Powered by <a href="https://gohugo.io">Hugo</a> and <a href="https://github.com/ecwu/ecwu-theme">ecwu-theme</a>.
      Build by GitHub Actions at: 2025-10-27 07:01 CST.
    </p>
    <p>
      
      &copy;2025
      ECWUUUUU.
      All rights reserved.
      

    </p>
    
    <p>
      <a href="http://beian.miit.gov.cn/"> 粤 ICP 备 17015575 号 - 1</a>
    </p>
    
    <p class="text-sm my-4">
       Google Analytics enabled   | <a href="https://ecwuuuuu.com/page/changelog">site changelog</a>
    </p>
  </footer>
</div>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-HSPDSQWH5L"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-HSPDSQWH5L');
        }
      </script>


    </body>
</html>
